<html lang=en><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content="ie=edge" http-equiv=X-UA-Compatible><title>给终端设置代理 </title><link href=https://piledog.github.io/favicon_150x150.png rel=icon><link href=https://piledog.github.io/main.css rel=stylesheet><body><header><div><a href=https://piledog.github.io> <h3>Piledog</h3> </a><nav class=nav><ul><li><a href=https://piledog.github.io/tag>Tag</a><li><a href=https://piledog.github.io/gallery>Gallery</a><li><a href=https://piledog.github.io/about>About</a></ul></nav></div></header><main><h1 style="text-align: center;display: block">给终端设置代理</h1><article><p>今天<code>brew</code>跟新包的时候, 速度是真的慢. 需要给终端设置代理, 一两条命令能搞定. 切换代理算是日常操作, 于是写个小函数方便使用.<pre class=language-bash data-lang=bash style=background-color:#282828;color:#fdf4c1aa;><code class=language-bash data-lang=bash><span style=color:#fdf4c1;>proxy_st</span><span style=color:#fe8019;>=</span><span style=color:#b8bb26;>off
</span><span style=color:#8ec07c;>toggle_proxy</span><span>() {
</span><span>    </span><span style=color:#fa5c4b;>if </span><span style=color:#fabd2f;>[ </span><span style=color:#b8bb26;>"$</span><span style=color:#fdf4c1;>proxy_st</span><span style=color:#b8bb26;>" </span><span style=color:#fe8019;>=</span><span style=color:#fdf4c1;> on </span><span style=color:#fabd2f;>]</span><span style=color:#fe8019;>; </span><span style=color:#fa5c4b;>then
</span><span>        </span><span style=color:#fabd2f;>unset</span><span style=color:#fdf4c1;> ALL_PROXY
</span><span>        </span><span style=color:#fdf4c1;>proxy_st</span><span style=color:#fe8019;>=</span><span style=color:#b8bb26;>off
</span><span>        </span><span style=color:#fabd2f;>echo</span><span style=color:#fdf4c1;> proxy is now </span><span style=color:#b8bb26;>"$</span><span style=color:#fdf4c1;>proxy_st</span><span style=color:#b8bb26;>"
</span><span>    </span><span style=color:#fa5c4b;>else
</span><span style=color:#fdf4c1;>        </span><span style=color:#fa5c4b;>export </span><span style=color:#fdf4c1;>ALL_PROXY</span><span style=color:#fe8019;>=</span><span style=color:#b8bb26;>"socks5://localhost:1080"
</span><span>        </span><span style=color:#fdf4c1;>proxy_st</span><span style=color:#fe8019;>=</span><span style=color:#b8bb26;>on
</span><span>        </span><span style=color:#fabd2f;>echo</span><span style=color:#fdf4c1;> proxy is now </span><span style=color:#b8bb26;>"$</span><span style=color:#fdf4c1;>proxy_st</span><span style=color:#b8bb26;>"
</span><span>    </span><span style=color:#fa5c4b;>fi
</span><span>}
</span></code></pre><p>之后切换代理就会比较方便了. 如果想在开启新终端时就启用代理, 在<code>rc</code>文件中调用一次该函数即可.<div class=note>一个小问题, 这个proxy_st变量会存在于全局范围. bash中该怎么声明函数范围的static变量呢?</div></article><time style="margin-top: 2em; display: inline-block;">2019-08-16</time></main><footer><hr><div>Generated by <a href=https://www.getzola.org target=_blank>Zola</a> with <span id=power></span></div></footer>