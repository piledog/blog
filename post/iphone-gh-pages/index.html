<html lang=en><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content="ie=edge" http-equiv=X-UA-Compatible><title>使用手机更新GitHub Pages </title><link href=https://piledog.github.io/favicon_150x150.png rel=icon><link href=https://piledog.github.io/main.css rel=stylesheet><body><header><div><a href=https://piledog.github.io> <h3>Piledog</h3> </a><nav class=nav><ul><li><a href=https://piledog.github.io/tag>Tag</a><li><a href=https://piledog.github.io/gallery>Gallery</a><li><a href=https://piledog.github.io/about>About</a></ul></nav></div></header><main><h1 style="text-align: center;display: block">使用手机更新GitHub Pages</h1><article><p>这篇文章将介绍如何使用手机更新GitHub Pages文章. 本文也是自己第一次使用手机完成并发布.<h2 id=zhun-bei-gong-zuo>准备工作</h2><ol><li>markdown(md)编辑器. 我使用的是iOS平台的Bear Notes未付费版本, 插入md标记很方便, 比系统自带的Notes更适合md的书写. iOS平台上的Drafts app付费版本功能更加强大, 其内建的js脚本功能会使体验更加一条龙. 安卓应该有更多的选择.<li>iOS自动化工具Shortcuts. 用于上传md文章的内容.<li>GitHub Actions. GitHub现在支持CI/CD了. 在md文件上传到远程仓库后, 拉取, 构建, 并提交. 本文不做详细讨论. 首次接触的可以看下我博客的workflow, 用的Zola构建. 官方的文档和GitHub Marketplace有更详细的说明和现成的用例.<li>Personal Access Token. 在GitHub settings > developer settings > personal access tokens中生成一个即可</ol><h2 id=shou-ji-duan-pei-zhi>手机端配置</h2><p>GitHub Pages静态博客的CI/CD之前就配置好了, 有了这些铺垫, 本文介绍的手机端配置主要就是Shortcuts的内容.<br> 根据官方的REST <a href=https://developer.github.com/v3/repos/contents/#create-or-update-a-file>API</a>, 创建文件请求为<code>PUT /repos/:owner/:repo/contents/:path</code>.<br> 请求头必填字段有<code>Authorization, Accept, User-Agent</code>.<br> 请求体为Json格式, 必填的有commit <code>message</code>, <code>committer</code>, 和base64编码的content(即markdown文本).<br> HEADERS:<pre class=language-yaml data-lang=yaml style=background-color:#282828;color:#fdf4c1aa;><code class=language-yaml data-lang=yaml><span style=font-weight:bold;color:#8ec07c;>Authorization</span><span>: </span><span style=color:#b8bb26;>token $personal_access_token
</span><span style=font-weight:bold;color:#8ec07c;>Accept</span><span>: </span><span style=color:#b8bb26;>application/vnd.github.v3+json
</span><span style=font-weight:bold;color:#8ec07c;>User-Agent</span><span>: </span><span style=color:#b8bb26;>$user_name
</span></code></pre><p>Request Body:<pre class=language-json data-lang=json style=background-color:#282828;color:#fdf4c1aa;><code class=language-json data-lang=json><span>{
</span><span>  </span><span style=color:#b8bb26;>"message"</span><span>: </span><span style=color:#b8bb26;>"new post"</span><span>,
</span><span>  </span><span style=color:#b8bb26;>"committer"</span><span>: {
</span><span>    </span><span style=color:#b8bb26;>"name"</span><span>: </span><span style=color:#b8bb26;>"iphone shortcut"</span><span>,
</span><span>    </span><span style=color:#b8bb26;>"email"</span><span>: </span><span style=color:#b8bb26;>"shortcut@bot.com"
</span><span>  },
</span><span>  </span><span style=color:#b8bb26;>"conetent"</span><span>: </span><span style=color:#b8bb26;>"$base64(new_post.md)"
</span><span>}
</span></code></pre><p>响应201即发送成功(构建失败默认有邮件通知).<hr><p>Zola的每篇博客需要固定格式的front matter, 而Bear没有模板的支持, 所以我把front matter的生成放在了Shortcuts里面, 这里就不再赘述了.</article><time style="margin-top: 2em; display: inline-block;">2019-09-23</time></main><footer><hr><div>Generated by <a href=https://www.getzola.org target=_blank>Zola</a> with <span id=power></span></div></footer>